<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · CounterMarking.jl</title><meta name="title" content="Reference · CounterMarking.jl"/><meta property="og:title" content="Reference · CounterMarking.jl"/><meta property="twitter:title" content="Reference · CounterMarking.jl"/><meta name="description" content="Documentation for CounterMarking.jl."/><meta property="og:description" content="Documentation for CounterMarking.jl."/><meta property="twitter:description" content="Documentation for CounterMarking.jl."/><meta property="og:url" content="https://HolyLab.github.io/CounterMarking.jl/reference/"/><meta property="twitter:url" content="https://HolyLab.github.io/CounterMarking.jl/reference/"/><link rel="canonical" href="https://HolyLab.github.io/CounterMarking.jl/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CounterMarking.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/HolyLab/CounterMarking.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/HolyLab/CounterMarking.jl/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#CounterMarking.density_map-Tuple{AbstractString}"><code>CounterMarking.density_map</code></a></li><li><a href="#CounterMarking.get_centroidsacc-Tuple{Matrix{Int64}}"><code>CounterMarking.get_centroidsacc</code></a></li><li><a href="#CounterMarking.gui-Tuple{AbstractString, Any}"><code>CounterMarking.gui</code></a></li><li><a href="#CounterMarking.meanshow"><code>CounterMarking.meanshow</code></a></li><li><a href="#CounterMarking.process_images-Tuple{AbstractString, Glob.GlobMatch}"><code>CounterMarking.process_images</code></a></li><li><a href="#CounterMarking.randshow"><code>CounterMarking.randshow</code></a></li><li><a href="#CounterMarking.segment_image-Tuple{AbstractMatrix{&lt;:ColorTypes.Color}}"><code>CounterMarking.segment_image</code></a></li><li><a href="#CounterMarking.spots-Tuple{ImageSegmentation.SegmentedImage}"><code>CounterMarking.spots</code></a></li><li><a href="#CounterMarking.stimulus_index-Tuple{ImageSegmentation.SegmentedImage, Any}"><code>CounterMarking.stimulus_index</code></a></li><li><a href="#CounterMarking.upperleft-Tuple{AbstractDict{Int64, Spot}, Any, Any}"><code>CounterMarking.upperleft</code></a></li><li><a href="#CounterMarking.writexlsx-Tuple{AbstractString, ImageSegmentation.SegmentedImage}"><code>CounterMarking.writexlsx</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.density_map-Tuple{AbstractString}" href="#CounterMarking.density_map-Tuple{AbstractString}"><code>CounterMarking.density_map</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nmarked = density_map(jldfile::AbstractString)</code></pre><p>Given a JLD2 file <code>jldfile</code> written by <code>gui</code>, return an array <code>nmarked</code> counting of the number of images with a urine spot in each pixel. Before counting, the images are flipped so that the stimulus segment is in the upper left corner.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L176-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.get_centroidsacc-Tuple{Matrix{Int64}}" href="#CounterMarking.get_centroidsacc-Tuple{Matrix{Int64}}"><code>CounterMarking.get_centroidsacc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">centroidsacc, nadj = get_centroidsacc(seg::SegmentedImage)</code></pre><p>Given a the index map <code>indexmap</code> of a segmented image, return an accumulator for each segment&#39;s centroid as well as the number of times two segments are adjacent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L64-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.gui-Tuple{AbstractString, Any}" href="#CounterMarking.gui-Tuple{AbstractString, Any}"><code>CounterMarking.gui</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gui(outbase, files)
gui(outbase, glob::GlobMatch)</code></pre><p>Run the graphical user interface (GUI) for CounterMarking. Supply the base name of the output files (e.g., &quot;my_results&quot;) and a list of image files to process (alternatively, supply a <code>glob&quot;pattern&quot;</code> that matches just the files you want to process).</p><p>The GUI will display the images and their segmentation, and allow the user to select the segments corresponding to the stimulus (yellow) and marked spots. The results will be save to:</p><ul><li><code>outbase.xlsx</code>: an Excel file with one sheet per image, containing summary  statistics on the stimulus spot and the selected spots.</li><li><code>outbase.jld2</code>: a JLD2 file with one dataset per image, containing the  segmented image, the selected spots, and the stimulus segment.</li></ul><p>The JLD2 file can be used by <a href="#CounterMarking.density_map-Tuple{AbstractString}"><code>density_map</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/gui.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.meanshow" href="#CounterMarking.meanshow"><code>CounterMarking.meanshow</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">meanshow(seg; kwargs...)
meanshow(img, seg; kwargs...)</code></pre><p>Display a segmented image using the mean color of each segment. The version with <code>img</code> displays the original image and the segmented image one atop the other, and zooming on one will zoom on the other.</p><div class="admonition is-info" id="Note-e6e918e6d706cc6c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e6e918e6d706cc6c" title="Permalink"></a></header><div class="admonition-body"><p>You must load the <code>ImageView</code> package to use this function.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/gui.jl#L275-L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.process_images-Tuple{AbstractString, Glob.GlobMatch}" href="#CounterMarking.process_images-Tuple{AbstractString, Glob.GlobMatch}"><code>CounterMarking.process_images</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_images(outfile::AbstractString, glob::GlobMatch; dirname=pwd())
process_images(outfile::AbstractString, glob::AbstractString; dirname=pwd())</code></pre><p>Process all images with filenames matching <code>glob</code> and save the results to <code>outfile</code>. Each image will be a separate sheet in the Excel file.</p><p>Optionally specify the <code>dirname</code> containing the images.</p><p><strong>Examples</strong></p><p>To process a collection of images in a different directory, and save the results to that same directory:</p><pre><code class="language-julia hljs">julia&gt; process_images(&quot;2025-03-15/results.xlsx&quot;, glob&quot;*.png&quot;; dirname=&quot;2025-03-15&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/xlxs.jl#L40-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.randshow" href="#CounterMarking.randshow"><code>CounterMarking.randshow</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">randshow(seg; kwargs...)
randshow(img, seg; kwargs...)</code></pre><p>Display a segmented image using random colors for each segment. The version with <code>img</code> displays the original image and the segmented image one atop the other, and zooming on one will zoom on the other.</p><p>!!! note You must load the <code>ImageView</code> package to use this function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/gui.jl#L263-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.segment_image-Tuple{AbstractMatrix{&lt;:ColorTypes.Color}}" href="#CounterMarking.segment_image-Tuple{AbstractMatrix{&lt;:ColorTypes.Color}}"><code>CounterMarking.segment_image</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seg = segment_image(img; threshold=0.1, min_size=20)</code></pre><p>Given an image <code>img</code>, segment it into regions using a region growing algorithm. <code>min_size</code> is the minimum number of pixels per segment, and <code>threshold</code> determines how different two colors must be to be considered different segments. Larger <code>threshold</code> values will result in fewer segments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.spots-Tuple{ImageSegmentation.SegmentedImage}" href="#CounterMarking.spots-Tuple{ImageSegmentation.SegmentedImage}"><code>CounterMarking.spots</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spotdict, stimulus = spots(seg; max_size_frac=0.1)</code></pre><p>Given a segmented image <code>seg</code>, return a <code>Dict(idx =&gt; spot)</code> where <code>idx</code> is the segment index and <code>spot</code> is a <code>Spot</code> object where <code>spot.npixels</code> is the number of pixels in the segment and <code>spot.centroid</code> is the centroid of the segment.</p><p><code>stimulus</code> is a <code>Pair{Int, Spot}</code> where the first element is the index of the stimulus segment and the second element is the <code>Spot</code> object for that segment.</p><p>Spots larger than <code>max_size_frac * npixels</code> (default: 10% of the image) are ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L98-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.stimulus_index-Tuple{ImageSegmentation.SegmentedImage, Any}" href="#CounterMarking.stimulus_index-Tuple{ImageSegmentation.SegmentedImage, Any}"><code>CounterMarking.stimulus_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">idx = stimulus_index(seg::SegmentedImage, centroidsacc; colorproj = RGB(1, 1, -2), expectedloc = nothing)</code></pre><p>Given a segmented image <code>seg</code>, return the index of the segment that scores highest on the product of (1) projection (dot product) with <code>colorproj</code> and (2) number of pixels.</p><p>Optionally, if images were taken with a fixed location for the stimulus, a segment&#39;s score is divided by the squared distance of its centroid (via <code>centroidsacc</code>) from the position given by <code>expectedloc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L24-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.upperleft-Tuple{AbstractDict{Int64, Spot}, Any, Any}" href="#CounterMarking.upperleft-Tuple{AbstractDict{Int64, Spot}, Any, Any}"><code>CounterMarking.upperleft</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spotdict_ul, stimulus_ul = upperleft(spotdict::AbstractDict{Int, Spot}, stimulus, imgsize)</code></pre><p>Given a <code>spotdict</code> of <code>Spot</code> objects and a <code>stimulus</code> segment, return a new <code>spotdict_ul</code> corresponding to an image flipped so that <code>stimulus_ul</code> is in the upper left corner.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/segment.jl#L147-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CounterMarking.writexlsx-Tuple{AbstractString, ImageSegmentation.SegmentedImage}" href="#CounterMarking.writexlsx-Tuple{AbstractString, ImageSegmentation.SegmentedImage}"><code>CounterMarking.writexlsx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">writexlsx(filename::AbstractString, seg::SegmentedImage)</code></pre><p>Save the segmented image data to an Excel file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HolyLab/CounterMarking.jl/blob/105ce8f716be0480c6bf7a8b238b6a6ab959327f/src/xlxs.jl#L29-L33">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.0 on <span class="colophon-date" title="Wednesday 9 July 2025 18:41">Wednesday 9 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
